<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>CoffeeScript Plugin 1.0-SNAPSHOT - Reference Documentation</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Style" charset="utf-8"/>
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    </head>
    <body class="body">
        <div id="header">
            <div class="images"><br/><br/>
                <a href="http://grails.org" target="_blank"><img alt="The Grails Framework" src="../img/grails.png" border="0"/></a>
                <span style="right:30px; top:20px; position:absolute;">
                    <a href="../index.html" target="_top">Frames</a> | <a href="index.html" target="_top">No Frames</a><br/><br/>
                    <a href="http://springsource.com" target="_blank"><img alt="SpringSource - A Division of VMware" src="../img/springsource-logo.png" border="0"/></a>
                </span>
            </div>
            <div class="message">coffeescript</div>
            <h1>CoffeeScript Plugin - Reference Documentation</h1>
            <p><strong>Authors:</strong> Jeff Brown</p>
            <p><strong>Version:</strong> 1.0-SNAPSHOT</p>
            <em></em>
        </div>

        <div id="toc">
            <h2>Table of Contents</h2>
            <div class="tocItem" style="margin-left:0px"><a href="#1. Introduction To The CoffeeScript Plugin">1. Introduction To The CoffeeScript Plugin</a></div><div class="tocItem" style="margin-left:0px"><a href="#2. Defining CoffeeScript Functions">2. Defining CoffeeScript Functions</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.1 Compiler Configuration Options">2.1 Compiler Configuration Options</a></div><div class="tocItem" style="margin-left:0px"><a href="#3. Calling CaffeeScript Functions From A GSP">3. Calling CaffeeScript Functions From A GSP</a></div><div class="tocItem" style="margin-left:0px"><a href="#4. Defining Inline CoffeeScript">4. Defining Inline CoffeeScript</a></div>
        </div>
        <div id="content">
            <h1><a name="1. Introduction To The CoffeeScript Plugin">1. Introduction To The CoffeeScript Plugin</a></h1>The CoffeeScript plugin provides support for taking advantage of CoffeeScript in a Grails application.<p class="paragraph"/>This document describes the CoffeeScript integration options in a Grails application.  For details about
the CoffeeScript language and general usage see <a href="http://jashkenas.github.com/coffee-script/" target="blank">jashkenas.github.com/coffee-script/</a>.
<h1><a name="2. Defining CoffeeScript Functions">2. Defining CoffeeScript Functions</a></h1>CoffeeScript functions may be defined in .coffee files under <code>src/coffee/</code>.  A simple
example:<p class="paragraph"/><div class="code"><pre>// src/coffee/math.coffee
window.multiplyNumbers = (x, y) &#45;&#62; result = x &#42; y;
msg = x + <span class="java&#45;quote">" &#42; "</span> + y + <span class="java&#45;quote">" is "</span> + result;
<span class="java&#45;keyword">return</span> msg</pre></div><p class="paragraph"/>All CoffeeScript source files should be defined under <code>src/coffee/</code> and should have the
<code>.coffee</code> extension.<p class="paragraph"/>At build time all of the <code>.coffee</code> files will be compiled to JavaScript using the <code>coffee</code> compiler
which must be available at build time.  The Grails application will have no runtime dependency
on the compiler.<h2><a name="2.1 Compiler Configuration Options">2.1 Compiler Configuration Options</a></h2>The plugin compiles the <code>.coffee</code> files which are defined under <code>src/coffee/</code> to JavaScript using the <code>coffee</code> compiler.  By default
the plugin will use the <code>coffee</code> compiler which is on the PATH at build time.  You may override this behavior by assigning a value
to the <code>grails.coffeescript.compiler.location</code> system property at build time.<p class="paragraph"/><div class="code"><pre>grails &#45;Dgrails.coffeescript.compiler.location=/opt/node/bin/coffee run&#45;app</pre></div><p class="paragraph"/>Another option is to assign a value to the <code>grails.coffeescript.compiler.location</code> property in
<code>grails-app/conf/BuildConfig.groovy</code>.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/BuildConfig.groovy
grails.coffeescript.compiler.location='/opt/node/bin/coffee'</pre></div><p class="paragraph"/>The order of preference is the system property, followed by the <code>BuildConfig</code> property and finally the compiler
found on the PATH.<p class="paragraph"/><blockquote class="note">
The compiler is only needed when compiling <code>.coffee</code> files under <code>src/coffee/</code>.  If the application does not
define any of those and is only using inline CoffeeScript, the compiler is not needed.
</blockquote><h1><a name="3. Calling CaffeeScript Functions From A GSP">3. Calling CaffeeScript Functions From A GSP</a></h1>The plugin provides a custom GSP tag for pulling a compiled CoffeeScript library into a page.  Note
that what is being pulled in to the page is the compiled JavaScript, not the CoffeeScript.<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
&#60;head&#62;
    &#60;coffee:js name=<span class="java&#45;quote">"math"</span>/&#62;
&#60;/head&#62;
&#60;body&#62;
    &#60;form name=<span class="java&#45;quote">"multiplicationForm"</span>&#62;
        X = &#60;g:textField name=<span class="java&#45;quote">"x"</span> value=<span class="java&#45;quote">""</span> /&#62;,
        Y = &#60;g:textField name=<span class="java&#45;quote">"y"</span> value=<span class="java&#45;quote">""</span> /&#62;
        &#60;input type=<span class="java&#45;quote">"button"</span> value=<span class="java&#45;quote">"Multiply"</span> onclick=<span class="java&#45;quote">"document.all.result.innerText=multiplyNumbers(x.value, y.value)"</span> /&#62;
    &#60;/form&#62;
    &#60;div id=<span class="java&#45;quote">"result"</span>&#62;&#60;/div&#62;
&#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/>The <code>js</code> tag in the <code>coffee</code> namespace requires that a value be assigned to the <code>name</code> attribute
which should correspond to the name of a <code>.coffee</code> file which is defined under 
<code>src/coffee/</code>.  The name should not include the <code>.coffee</code> or <code>.js</code> extension.<h1><a name="4. Defining Inline CoffeeScript">4. Defining Inline CoffeeScript</a></h1>The plugin provides support for embedding CoffeeScript code directly in a GSP page using the <code>inline</code> GSP tag which
is defined in the <code>coffee</code> namespace.<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
&#60;body&#62;
    &#60;coffee:inline&#62;
        window.addNumbers = (x, y) &#45;&#62; result = <span class="java&#45;object">Number</span>(x) + <span class="java&#45;object">Number</span>(y);
        msg = x + <span class="java&#45;quote">" + "</span> + y + <span class="java&#45;quote">" is "</span> + result;
        document.all.result.innerText = msg
    &#60;/coffee:inline&#62;
    &#60;form name=<span class="java&#45;quote">"additionForm"</span>&#62;
        X = &#60;g:textField name=<span class="java&#45;quote">"x"</span> value=<span class="java&#45;quote">""</span> /&#62;,
        Y = &#60;g:textField name=<span class="java&#45;quote">"y"</span> value=<span class="java&#45;quote">""</span> /&#62;
        &#60;input type=<span class="java&#45;quote">"button"</span> value=<span class="java&#45;quote">"Add"</span> onclick=<span class="java&#45;quote">"addNumbers(x.value, y.value)"</span> /&#62;
    &#60;/form&#62;
    &#60;div id=<span class="java&#45;quote">"result"</span>&#62;&#60;/div&#62;
&#60;/body&#62;
&#60;/html&#62;</pre></div>
        </div>
        <div id="footer">
             
        </div>
    </body>
</html>
